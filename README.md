# PAR-Light-Sensor

This project uses a AS7341 light sensor as a low cost alternative to a quantum sensor to make a Photosynthetic Photon Flux Density (PPFD) measurement. This sensor does not have a flat sensitivity throughout the 400-700 nm range, but has seven measurement channels spanning the range. As such, it is most accurate when used with the specific type of light or fixture for which is has been calibrated.

A description of the work to develop and test the sensor can be found in this article. 
https://www.ctahr.hawaii.edu/oc/freepubs/pdf/FST-68.pdf

**Background**
The range of light wavelengths which is useful to plants is referred to as Photosynthetically Active Radiation (PAR) range. PAR is measured with a quantum light meter which counts the number of photons, or light particles, within the PAR range hitting the sensor and is commonly expressed in the units of micromoles per square meter per second (µmol/m2/s). This quantity is referred to as the Photosynthetic Photon Flux Density (PPFD). A mole (mol) is simply a unit to count the photons, and there are one million micromoles (µmol) in each mole.

The PPFD, or light intensity, is used to determine the total light provided to plants over the course of a day. This parameter is the Daily Light Integral (DLI) and is expressed in units of mol/m2/d. The DLI is calculated by multiplying the PPFD by the duration of time in hours (T) that the plant receives light and then performing a unit conversion by multiplying by a factor of 3600 (seconds in one hour) and dividing by a million to convert from units of micromoles to moles. As an example, hydroponic lettuce requires 14 - 17 mol/m2 PAR each day. Over a 16-hour light period, the PPFD would need to fall between 243 - 295 µmol/m2/s. The DLI determination for an indoor operation using grow lights is very simple since the light intensity does not change over the course of the day.

**AS7341 Sensor**
The custom PPFD meter was designed to be cost effective and simple to build and assemble (Figure 3). The two main components are the light sensor and a microcontroller that communicates with the sensor and displays readings to the user. The sensor is positioned at the top of a 3D printed case that can be handheld or mounted to a tripod or articulating arm with a ¼”-20 threaded mount. The Adafruit ESP32 S2 TFT Feather microcontroller selected can send readings to a computer through a USB connection or wirelessly over WiFi and Bluetooth and has a built-in LCD screen to display measurements in real time to the user. The connection to the sensor also does not require soldering. Other components include a cable connecting the sensor and microcontroller, USB cable for data transfer and to upload the code to run the microcontroller, mounting screws, and an acrylic diffuser for the sensor.

The three-part case was 3D printed with a filament deposition printer (Pulse XE). The main body incorporates mounting holes to secure the microcontroller and sensor to the case. The 3D printed cap contains a pocket to hold a circular light diffuser that scatters light from oblique sources, or extreme angles, which might otherwise cast a shadow on the sensor from the edges of the sensor chip package. A rectangular plate covers the main compartment of the case to protect the microcontroller. Metric M2.3, 2.5 or 2.6 self-tapping screws attach the sensor, microcontroller, cap, and cover plate to the main body. 

![image](https://github.com/ryan-ext/PAR-Light-Sensor/assets/142383030/f856e4ae-624b-4c3b-89b5-0f4f500283f2)

**PPFD Calibration**
The raw photon counts of the sensors were converted to actual PPFD values through a calibration process that used a quantum meter (Spectrum Technologies Solar Electric Quantum Meter #3415FSE) as the reference for PPFD. This quantum meter has settings for electric and solar light. The electric light setting was used with all grow lights regardless of type. A mounting bracket kept the angle, height, and position of the reference meter and light sensors consistent to ensure that all devices were exposed to the same light conditions when under an LED grow light. A range of PPFD through a maximum of 700 µmol/m2/s, typical for indoor agriculture, were produced by changing the light intensity, height of the grow light, and horizontal position under the light. Readings from the reference meter and AS7341 were recorded when each was centered on nine positions designated on a grid below the light fixture.

Readings from both the reference meter and AS7341 were observed to increase consistently as the light intensity was raised. This type of proportional or linear relationship shown in Figure 8 for full spectrum LED indicates that the conversion of the photon count to a PPFD reading can accomplished with the formula for a straight line. The PPFD value is calculated by multiplying the sensor photon count by the slope of the line and then adding that product to the offset or y-intercept value. For example, the raw photon count of the AS7341 must be divided by 32.75. The resulting value is a PPFD reading in units of µmol/m2/s. In this particular calibration result, there is no significant offset between the sensor output and quantum meter reading. 

![image](https://github.com/ryan-ext/PAR-Light-Sensor/assets/142383030/f21fbda6-fff8-4ba7-a19d-2fda2bfc5fa9)

